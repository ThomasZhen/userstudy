<!DOCTYPE html>
<html>
   <head>
     <!-- Add this line to remove the Cannot get Favicon.ico to display error in
     the console -->

     <!-- Failed to load resource: the server responded with a status of 404 (Not Found) -->
     <!-- Cannot GET /favicon.ico -->
     <!-- :3000/favicon.ico:1  -->


     <script type="text/javascript" src="/script/script.js"></script>


     <!-- The css file has to be placed in a folder name static -->
     <link rel="stylesheet" href="static/style.css">



     <link rel="stylesheet" href= 
"https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"> 
     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

     <!-- D3 library -->
     <script src="https://d3js.org/d3.v6.min.js"></script>

 
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


     <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>



    <link href="/favicon.ico" type="image/x-icon" rel="icon" />
    <script src = "/socket.io/socket.io.js"></script>
    <script src="https://unpkg.com/force-graph@1.30.2/dist/force-graph.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
     <!-- For 3D -->
    <!--  <script src="https://unpkg.com/3d-force-graph@1.66.6/dist/3d-force-graph.min.js"></script> -->

   </head>


   <body class="body">
   <!--  <div>
        <p id="test">Okay</p>
    </div> -->


    <div class="container-fluid">
        <div class="row firstRow">

          <div class="leftColumn col-2">
            <!-- These are a lot of rows -->

            <!-- <div class="row">
                <h4 class="headerStyle">Display the dataset</h4>
            </div> -->


            <!--  <div class="container">
                <a href="#" data-toggle="tooltip" title="Hooray!">Display the dataset</a>
            </div> -->


           <!--   <div class="container">
                <h3>Tooltip Example</h3>
                <a href="#" data-toggle="tooltip" title="Hooray!" data-placement="bottom">Hover over me</a>
            </div>
 -->

           <!--  <button type="button" class="btn btn-default" data-toggle="tooltip" data-placement="right" title="Tooltip on right">Tooltip on right</button>
            <div class="row"> -->

            <div class="row">
                <h4 data-toggle="tooltip" data-placement="bottom" title="
                Click the display button to display the dataset">
                Display the dataset</h4>
            </div>

            <div class="row">


                <!-- Testing code -->
                <!-- <div id="dataSet"></div> -->

                <!--  <select class="buttonStyle" id="datasetOption">
                    <option>dataset 3980</option>
                    <option>dataset 3437</option>
                    <option>dataset 3080</option>
                    <option>dataset 698</option>
                    <option>dataset 414</option>
                    <option>dataset 348</option>
                    <option>dataset 107</option>
                </select> -->



                 <button class="buttonStyle" onclick="displayOriginal()">Display</button>

                 <!-- <button class="buttonStyle" onclick="displayDataset()">Display</button> -->

            </div>


            <hr class="lineStyle">




            <div class="row">
                <h4 data-toggle="tooltip" data-placement="bottom" title="
                Choose a property from the drop down list and click the 
                Display button to display only the part of the data set that
                match the property value
                ">
                Display property dataset</h4>
            </div>


            <div class="row">
                 <div id="container"></div>
            </div>


            <div class="row">
                <input class="buttonStyle" type="button" value="Display"  onclick="changeOpt()"/>
            </div>


            <!-- <div class="row"> -->
                <hr class="lineStyle">
            <!-- </div> -->



            <!-- Node styling -->
             <div class="row">
                <h4 data-toggle="tooltip" data-html="true" data-placement="bottom" title="
                SetNodeSize: enter a positive integer. <br>
                SetNodeVisibility: enter true or false. <br>
                SetNodeColor: enter a color name. <br>
                ">
                Node Styling</h4>
            </div>





            <div class="row">
                <select class="buttonStyle" id="nodeOption">
                    <option>SetNodeSize</option>
                    <option>SetNodeVisibility</option>
                    <option>SetNodeColor</option>
                </select>
                <input class="buttonStyle" type="text" id="nodeInput">
            </div>
            <div class="row">
                <input class="buttonStyle" type="button" value="Execute"  onclick="changeNode()"/>
            </div>



            <!-- <div class="row"> -->
                <hr class="lineStyle">
            <!-- </div> -->



            <!-- Link styling -->
            <div class="row">
                <h4 data-toggle="tooltip" data-html="true" data-placement="bottom" title="
                
                SetLinkVisibility: enter true or false. <br>
                
                SetLinkColor: enter a color name. <br>
                
                SetLinkLineDash: enter two positive values and seperate them by a comma. <br>
                
                SetLinkWidth: enter a positive integer. <br>
                
                SetLinkCurvature: enter a positive integer. <br>
                
                SetLinkDirectionalArrowLength: enter a positive integer greater than 3. <br>
                
                SetLinkDirectionalArrowColor: enter a color value. <br>
                
                SetLinkDirectionalArrowRelPos: enter a floating number beteen 0 and 1. <br>
                
                SetLinkDirectionalParticles: enter a positive integer. <br>
                
                SetLinkDirectionalParticleSpeed: enter a floating number between 0.01 and 0.1 <br>
                
                SetLinkDirectionalParticleWidth: enter a positive integer value. <br>
                
                SetLinkDirectionalParticleColor: enter a color name. <br>
                
                ">
                Link Styling</h4>
            </div>


            <div class="row">
                <select class="buttonStyle" id="linkOption">
                    <option>SetLinkVisibility</option>
                    <option>SetLinkColor</option>
                    <option>SetLinkLineDash</option>
                    <option>SetLinkWidth</option>
                    <option>SetLinkCurvature</option>
                    <option>SetLinkDirectionalArrowLength</option>
                    <option>SetLinkDirectionalArrowColor</option>
                    <option>SetLinkDirectionalArrowRelPos</option>
                    <option>SetLinkDirectionalParticles</option>
                    <option>SetLinkDirectionalParticleSpeed</option>
                    <option>SetLinkDirectionalParticleWidth</option>
                    <option>SetLinkDirectionalParticleColor</option>
                </select>
               <!--  <input class="buttonStyle" type="text" id="linkInput"> -->
            </div>
            <div class="row">
                 <input class="buttonStyle" type="text" id="linkInput">
            </div>
            <div class="row">
                <input class="buttonStyle" type="button" value="Execute"  onclick="changeLink()"/>
            </div>

            <!-- <div class="row"> -->
                <hr class="lineStyle">
            <!-- </div> -->



            <div class="row">
                <h4 class="headerStyle">Pause or resume the animation</h4>
            </div>

            <div class="row">
                <form>
                    <!-- <input id="rbt1" type="radio" name="choice" value="pause" onclick="renderControl()" class="rbt"> pause
                    <input id="rbt2" type="radio" name="choice" value="resume" onclick="renderControl()" class="rbt"> resume -->

                     <span><input id="rbt1" type="radio" name="choice" value="pause" onclick="renderControl()"><span class="rbt">pause</span></span>
                     <span><input id="rbt1" type="radio" name="choice" value="resume" onclick="renderControl()"><span class="rbt">resume</span></span>

                </form>
            </div>


            <!-- <div class="row"> -->
                <hr class="lineStyle">
            <!-- </div> -->

            <div class="row">
                <h4 data-toggle="tooltip" data-html="true" data-placement="bottom" title="
                First display the main graph
                Then choose two different properties. <br>
                Then select the charts you want to display and click the Execute button. <br>
                Note: It is not neccessary for any two properties to have a matched data sets. <br>
                ">
                Display datafacts charts and datafacts</h4>
            </div>


            <div class="row" id="option1Container">
                <div id="option1"></div>
            </div>
            <div class="row" id="option2Container">
                 <div id="option2"></div>
            </div>
            <div class="row">
                <!-- <select class="buttonStyle" id="chartOption">
                    <option>Line Chart</option>
                    <option>Bar Chart</option>
                    <option>Area Chart</option>
                    <option>Stepped Area Chart</option>
                    <option>Column Chart</option>
                    <option>Combo Chart</option>
                </select> -->
                <form class="buttonStyle" id="chartOption">
                    <input type="checkbox" id="line chart">
                    <label for="line chart">Line Chart</label><br>
                    <input type="checkbox" id="bar chart">
                    <label for="bar chart">Bar Chart</label><br>
                    <input type="checkbox" id="area chart">
                    <label for="area chart">Area Chart</label><br>
                    <input type="checkbox" id="stepped area chart">
                    <label for="stepped area chart">Stepped Area Chart</label><br>
                    <input type="checkbox" id="column chart">
                    <label for="column chart">Column Chart</label><br>
                    <input type="checkbox" id="combo chart">
                    <label for="combo chart">Combo Chart</label><br>
                </form>
            </div>
            <div class="row">
                <input class="buttonStyle" type="button" value="Execute"  onclick="chartOpt()"/>
            </div>


           <!--  <div class="row">
                <input class="buttonStyle" type="button" value="Reset Node Color" onclick="resetNodeColor()"/>
            </div> -->

            <!-- Testing code -->
            <!-- <div class="row">
                <button type="button" id="hideSales"  >Hide Sales</button>
                <button type="button" id="hideExpenses"  >Hide Expence</button>
            </div> -->
            <!-- Testing code -->


          </div>
          


          <div class="middleColumn col-8">
            <!-- There are two rows  -->
            <div class="row">
              <div class="col-12">
                <div class="row">
                    <h6 class="headerStyle">Display the graph</h6>

                    <input class="buttonStyle2" type="button" value="Reset the Graph" onclick="resetNodeColor()"/>
                </div>
                    <div id="displayGraph"></div> 
              </div>
            </div>

        <!--     <div class="row">
              <div class="col-6">
                <h6 class="headerStyle">Display the charts</h6>
                <div id="chart"></div>
              </div>
              <div class="col-6">
                <h6 class="headerStyle">Display the data facts</h6>
                <div id="df"></div>
              </div>
            </div> -->


            <div class="row">
              <div class="col-12">
                <div class="row">

                    <!-- <h6 class="headerStyle">Display the charts</h6> -->
                    <!-- <div id="chart" class="data1"></div> -->


                    <h6 data-toggle="tooltip" data-html="true" data-placement="bottom" title="
                    You click on the line or a small icon on the right, the line will disappear.<br>
                    You want the line to come back, click on the small icon on the right again.<br>
                    First time click on a node in the chart, the colors go black, second time, the color becomes normal.<br>
                    ">
                    Display the charts</h6>


                    <input class="buttonStyle2" type="button" value="Reset the Graph" onclick="resetNodeColor()"/>
                 </div>


                <div class="row">

                    <div id="chart1"></div>
                    <div id="chart2"></div>
                    <div id="chart3"></div>
                    <div id="chart4"></div>
                    <div id="chart5"></div>
                    <div id="chart6"></div>
                    <div id="chart7"></div>
                    
                </div>


              </div>
            </div>


            <div class="row">
              <div class="col-12">
                <h6 class="headerStyle">Display the data facts</h6>
                <div id="df"></div>
              </div>
            </div>
          </div>



          <div class="rightColumn col-2">
                <div class="row">
                    <h4 data-toggle="tooltip" data-html="true" data-placement="bottom" title="
                        Click on the text to hightlight the related nodes. <br>
                        Note: it is not necessary the related nodes are displayed in the graph <br>
                        ">
                        Some statistics at the graph level</h4>
                    <ul id="graphStatistics"></ul>
                </div>
               

                <div class="row">
                    <form>
                     <span><input id="rbt10" type="radio" name="choice1" value="show" onclick="graphDatafactControl()"><span class="rbt">show</span></span>
                     <span><input id="rbt11" type="radio" name="choice1" value="hide" onclick="graphDatafactControl()"><span class="rbt">hide</span></span>
                    </form>
                </div>



                <div class="row">
                    <h4 class="headerStyle">Some statistics at the node level</h4>
                    <ul id="nodeStatistics"> </ul>
                    <ul id="nodeStatisticsAdditional"></ul>
                </div>
                

                <div class="row">
                    <form>
                     <span><input id="rbt20" type="radio" name="choice2" value="show" onclick="nodeDatafactControl()"><span class="rbt">show</span></span>
                     <span><input id="rbt21" type="radio" name="choice2" value="hide" onclick="nodeDatafactControl()"><span class="rbt">hide</span></span>
                    </form>
                </div>


                    <h4 class="headerStyle">Enter a node number to find its links(place the mouse over a node in the graph to find its node number)</h4>
                <input class="buttonStyle" type="text" id="nodeStatisticsInput">
                <input class="buttonStyle" type="button" value="Submit"  onclick="getNodeStatistics()"/>
          </div>

      </div>
    </div>



    

    <script type="text/javascript">
       $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
        


        var oldOption1 = "";
        var oldOption2 = "";


        // For google charts
        google.charts.load('current', {'packages':['line']});

        google.charts.load('current', {'packages':['bar']});

        google.charts.load('current', {'packages':['corechart']});


        // google.charts.setOnLoadCallback(drawChart);

        // google.charts.setOnLoadCallback(drawBarChart);
        // google.charts.setOnLoadCallback(drawChart);


        var content;
        var mainGraph;
        var mainNode;
        var mainData;
        var windowSize = false;

        var groupArray;

        // The total number of nodes
        var totalNodes = 0;
        // Node counter to count the number of nodes for the chage color function
        var countTotalNodes = 0;
        // An array to store the cross linking nodes
        var nodeArray = [];

        // Color array for the charts
        var colorArray = ['red', 'blue', 'green', 'yellow', 'purple', 'pink', 'gold', 'dark green', 'LightSalmon', 'MediumPurple', 'OrangeRed', 'SpringGreen', 'YellowGreen', 'SeaGreen', 'Silver', 'Teal', 'SpringGreen', 'YellowGreen', 'Violet', 'Wheat', 'WhiteSmoke', 'Yellow', 'SteelBlue', 'Tan', 'SlateBlue', 'SkyBlue', 'Sienna', 'SeaShell', 'SandyBrown', 'Salmon', 'SaddleBrown', 'RoyalBlue', 'RosyBrown', 'RebeccaPurple', 'PowderBlue', 'Plum', 'Peru', 'PeachPuff', 'PapayaWhip', 'PaleVioletRed', 'PaleTurquoise', 'PaleGreen', 'PaleGoldenRod', 'Orchid', 'OrangeRed', 'Orange', 'OliveDrab', 'Olive', 'OldLace', 'Navy', 'NavajoWhite', 'Moccasin', 'MistyRose', 'MintCream', 'MidnightBlue', 'MediumVioletRed', 'MediumTurquoise', 'MediumSpringGreen', 'MediumSlateBlue', 'MediumSeaGreen', 'MediumPurple', 'MediumOrchid', 'MediumBlue', 'MediumAquaMarine', 'Maroon', 'Magenta', 'Linen', 'LimeGreen', 'Lime', 'LightYellow', 'LightSteelBlue', 'LightSlateGrey', 'LightSlateGray', 'LightSkyBlue', 'LightSeaGreen', 'LightPink', 'LightGreen', 'LightGrey', 'LightGray', 'LightGoldenRodYellow', 'LightCyan', 'LightCoral', 'LightBlue', 'LemonChiffon', 'LawnGreen', 'LavenderBlush', 'Lavender', 'Khaki', 'Ivory', 'Indigo', 'IndianRed', 'HotPink', 'HoneyDew', 'GreenYellow', 'grey', 'GoldenRod', 'GohostWhite', 'Gainsboro', 'Fuchsia', 'ForestGreen', 'FloralWhite', 'FireBrick', 'DodgerBlue', 'DimGrey', 'DimGray', 'DeepSkyBlue', 'DeepPink', 'DarkViolet', 'DarkTurquoise', 'DarkSlateGrey', 'DarkSlateGray', 'DarkSlateBlue', 'DarkSeaGreen', 'DarkSalmon', 'DarkRed', 'DarkOrchid', 'DarkOrange', 'DarkOliveGreen', 'DarkMagenta', 'DarkKhaki', 'DarkGreen', 'DarkGrey', 'DarkGray', 'DarkGoldenRod', 'DarkCyan', 'DarkBlue', 'Cyan', 'Crimson', 'Cornsilk', 'CornflowerBlue', 'Coral', 'Chocolate', 'Chartreuse', 'CadetBlue', 'BurlyWood', 'Brown', 'BlueViolet', 'BlanchedAlmond', 'Bisque', 'Beige', 'Azure', 'Aquamarine', 'Aqua', 'AntiqueWhite', 'AliceBlue'];

        // var colorNames = [
        
        // "Aquamarine", "BurlyWood", "Chocolate", "Cyan", "DarkCyan", "DarkGoldenRod", "DarkGreen",
        // "DarkOrange", "DarkSeaGreen", "DarkSlateGrey", "DimGray", "Green", "Fuchsia", "HotPink" 

        // ];


        var lineChart;
        var lineData;
        var lineOption;
        var lineColumns = [];
        var lineSeries = {};


        var barChart;
        var barData;
        var barOption;
        var barColumns = [];
        var barSeries = {};


        var areaChart;
        var areaData;
        var areaOption;
        var areaColumns = [];
        var areaSeries = {};


        var steppedAreaChart;
        var steppedAreaData;
        var steppedAreaOption;
        var steppedAreaColumns = [];
        var steppedAreaSeries = {};


        var columnChart;
        var columnData;
        var columnOption;
        var columnColumns = [];
        var columnSeries = {};


        var comboChart;
        var comboData;
        var comboOption;
        var comboColumns = [];
        var comboSeries = {};


        var newOption1;
        var newOption2;
        var newName1;
        var newName2;



        var listCharts = [0,0,0,0,0,0];
        var listDatas = [0,0,0,0,0,0];
        var listOptions = [0,0,0,0,0,0];
        var listColumns = [0,0,0,0,0,0];
        var listSeries = [0,0,0,0,0,0];

        var lineCounter = 3;
        var barCounter = 3;
        var areaCounter = 3;
        var steppedAreaCounter = 3;
        var columnCounter = 3;
        var comboCounter = 3;
        // var counter = 3;


        var lineView;
        var barView;
        var areaView;
        var steppedAreaView;
        var columnView;
        var comboView;

        var socket = io();

        // ---------------- Getting the values from back end -------------

        socket.on('displayOriginalData', function(data){
            content = data;
        });


        socket.on('getGroupArray', function(data){
            groupArray = data;
        });


        var tt3 = [];
        socket.on('gettingKeysMap2', function(keys){
            // tt3 stores all the property names with the actual values with it
            tt3 = keys;

            var select = document.createElement("select");
            
            select.id = "sel";
            // select.class = "buttonStyle";
            // Follow tt3's property names to create options
            for (var val of tt3) {
                var option = document.createElement("option");
                option.value = val;
                option.text = val.charAt(0).toUpperCase() + val.slice(1);
                // option.class = "buttonStyle";
                select.appendChild(option);
            }

            // $('.container').empty();
            document.getElementById("container").appendChild(select);
            document.getElementById("sel").style.backgroundColor = "white";
            document.getElementById("sel").style.color = "black";
        });



        // Might not need this part
        var tt4 = [];
        socket.on('gettingValuesMap2', function(values){
            // tt4 stores all the property names position number in the featnames file
            tt4 = values;
        });
        

        // the unique property names are here
        var tt5 = [];
        socket.on('gettingKeysMap3', function(values){

            tt5 = values;

            var div1 = document.getElementById('sel1');
            if(div1 != null){
                div1.parentNode.removeChild(div1); 
            }

            var select1 = document.createElement("select");
            
            select1.id = "sel1"

            for (var val of tt5) {
                var option = document.createElement("option");
                option.value = val;
                option.text = val.charAt(0).toUpperCase() + val.slice(1);
                select1.appendChild(option);
            }

            // $('#sel1').empty();

            document.getElementById("option1").appendChild(select1);
            document.getElementById("sel1").style.backgroundColor = "white";
            document.getElementById("sel1").style.color = "black";


            var div2 = document.getElementById('sel2');
            if(div2 != null){
                div2.parentNode.removeChild(div2); 
            }

            var select2 = document.createElement("select");
            
            select2.id = "sel2"
            
            for (var val of tt5) {
                var option = document.createElement("option");
                option.value = val;
                option.text = val.charAt(0).toUpperCase() + val.slice(1);
                select2.appendChild(option);
            }

            // $('#sel2').empty();

            document.getElementById("option2").appendChild(select2);
            document.getElementById("sel2").style.backgroundColor = "white";
            document.getElementById("sel2").style.color = "black";
        });


        // the actual values for the property are here
        var tt6 = [];
        socket.on('gettingValuesMap3', function(values){
            tt6 = values;
        });



        socket.on('getStatistics', function(circleNumber, totalLinks, numGroup, largest, largestGroup, smallest, smallestGroup){


            var graphList = document.getElementById("graphStatistics");
            // The total number of groups

            graphList.innerHTML += "<li>There are " + circleNumber + " groups in this dataset</li>";


            // The total number of links
            graphList.innerHTML += "<li>There are " + totalLinks + " links in this dataset</li>";
            // Number of nodes in each group
            for(var i = 0; i < numGroup.length; i++){
                // graphList.innerHTML += "<li>Group " + i + " has " + numGroup[i] + " nodes</li>";

                graphList.innerHTML += "<li>Group " + i + " has " + numGroup[i] + " nodes";

                // To print the node number
                // for(var j = 0; j < groupArray[i].length; j ++){
                //      graphList.innerHTML += groupArray[i][j] + " ";
                // }


                graphList.innerHTML += "</li>";


                // console.log("The groupArray in here is");
                // console.log(groupArray);
            }



            // Number of nodes in each group
            // What is the largest group, how many nodes in it?
            graphList.innerHTML += "<li>The largest group in this dataset is " + largestGroup + " , there are " + largest + " nodes in it</li>";
            // What is the smallest group, how many nodes in it?
             graphList.innerHTML += "<li>The smallest group in this dataset is " + smallestGroup + " , there are " + smallest + " nodes in it</li>";

             graphList.style.color = "black";

             // -------- add onClick event -----------
             graphList.addEventListener("click", clickText, true);

        });



        socket.on('getNodeDatafactStatistics', function(totalNodes, greatestLinkNode, greatestLinksNum){

            var nodeList = document.getElementById("nodeStatistics");
            // How many nodes are there?
            nodeList.innerHTML += "<li>There are " + totalNodes + " nodes in this dataset</li>";
            // Which node has the greatest number of links
            nodeList.innerHTML += "<li>Node " + greatestLinkNode + " has the greatest number of links, it has " + greatestLinksNum + " links</li>";
            
            nodeList.style.color = "black";

            // Testing code
            nodeList.addEventListener("click", clickText, true);

        });


        socket.on('getTotalNodes', function(data){
            totalNodes = data;
        });



// --------------- End of getting the values from backend ------------

    </script>


   </body>
</html>
